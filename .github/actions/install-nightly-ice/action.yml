name: Instal Nightly Ice

runs:
  using: "composite"
  steps:
    - name: Install Ice Brew Formula
      if: runner.os == 'macOS'
      shell: bash
      run: |
        brew install zeroc-ice/nightly/ice

    - name: Install Ice Linux Repository
      if: runner.os == 'Linux'
      shell: bash
      run: |

        # Check for Red Hat based systems. We assume RHEL9 for now.
        if [ -f /etc/redhat-release ]; then
          dnf install https://download.zeroc.com/ice/nightly/el9/ice-repo-nightly-1.0.0-1.el9.noarch.rpm
          dnf install libice-c++-devel
        else
            wget https://download.zeroc.com/ice/nightly/ubuntu24.04/ice-repo-nightly_1.0_all.deb -O ice-repo-nightly.deb
            sudo dpkg -i ice-repo-nightly.deb
            rm ice-repo-nightly.deb

            sudo apt-get update
            sudo apt-get install -y libzeroc-ice-dev
        fi
